<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="妄言妄语当不得真,疯言疯语不足为信"><title>python programming FAQ | 吃饭不喝汤</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.0/jquery.min.js"></script><link rel="icon" mask sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">python programming FAQ</h1><a id="logo" href="/.">吃饭不喝汤</a><p class="description">饿了就吃饭渴了就喝水</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">python programming FAQ</h1><div class="post-meta">Sep 12, 2017</div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Core-Language"><span class="toc-number">1.</span> <span class="toc-text">Core Language</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#why-am-i-getting-an-UnboundLocalError-when-the-cariable-has-a-value"><span class="toc-number">1.1.</span> <span class="toc-text">why am i getting an UnboundLocalError when the cariable has a value?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What-are-the-rules-for-local-and-global-variables-in-Python"><span class="toc-number">1.2.</span> <span class="toc-text">What are the rules for local and global variables in Python</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Why-do-lambdas-defined-in-a-loop-with-different-values-all-return-the-same-result"><span class="toc-number">1.3.</span> <span class="toc-text">Why do lambdas defined in a loop with different values all return the same result?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-do-I-share-global-variables-across-modules"><span class="toc-number">1.4.</span> <span class="toc-text">How do I share global variables across modules?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Why-are-default-values-shared-between-objects"><span class="toc-number">1.5.</span> <span class="toc-text">Why are default values shared between objects?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-can-i-pass-optional-or-keyword-parameters-from-one-func-to-another"><span class="toc-number">1.6.</span> <span class="toc-text">How can i pass optional or keyword parameters from one func to another?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What-is-the-difference-between-arguments-and-parameters"><span class="toc-number">1.7.</span> <span class="toc-text">What is the difference between arguments and parameters?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Why-did-changing-list-‘y’-also-change-list-‘x’"><span class="toc-number">1.8.</span> <span class="toc-text">Why did changing list ‘y’ also change list ‘x’?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-do-you-make-a-higher-order-function-in-Python"><span class="toc-number">1.9.</span> <span class="toc-text">How do you make a higher order function in Python?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-do-I-copy-an-object-in-Python"><span class="toc-number">1.10.</span> <span class="toc-text">How do I copy an object in Python?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Is-there-an-equivalent-of-C’s-“-”-ternary-operator"><span class="toc-number">1.11.</span> <span class="toc-text">Is there an equivalent of C’s “?:” ternary operator ?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-do-i-modify-a-string-in-place"><span class="toc-number">1.12.</span> <span class="toc-text">How do i modify a string in place?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-do-I-use-strings-to-call-functions-methods"><span class="toc-number">1.13.</span> <span class="toc-text">How do I use strings to call functions/methods?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#What-is-the-most-efficient-way-to-concatenate-many-strings-together"><span class="toc-number">1.14.</span> <span class="toc-text">What is the most efficient way to concatenate many strings together?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-do-I-iterate-over-a-sequence-in-reverse-order"><span class="toc-number">1.15.</span> <span class="toc-text">How do I iterate over a sequence in reverse order?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-do-you-remove-duplicates-from-a-list"><span class="toc-number">1.16.</span> <span class="toc-text">How do you remove duplicates from a list?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-do-you-make-an-array-in-Python"><span class="toc-number">1.17.</span> <span class="toc-text">How do you make an array in Python?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-do-I-create-a-multidimensional-list"><span class="toc-number">1.18.</span> <span class="toc-text">How do I create a multidimensional list?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Why-does-a-tuple-i-‘item’-raise-an-exception-when-the-addition-works-¶"><span class="toc-number">1.19.</span> <span class="toc-text">Why does a_tuple[i] += [‘item’] raise an exception when the addition works?¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-can-I-sort-one-list-by-values-from-another-list"><span class="toc-number">1.20.</span> <span class="toc-text">How can I sort one list by values from another list?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#My-class-defunes-del-but-it-is-not-called-when-i-delete-the-object"><span class="toc-number">1.21.</span> <span class="toc-text">My class defunes del but it is not called when i delete the object</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Why-does-the-result-of-id-appear-to-be-not-unique"><span class="toc-number">1.22.</span> <span class="toc-text">Why does the result of id() appear to be not unique?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-do-I-find-the-current-module-name"><span class="toc-number">1.23.</span> <span class="toc-text">How do I find the current module name?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#How-can-I-have-modules-that-mutually-import-each-other"><span class="toc-number">1.24.</span> <span class="toc-text">How can I have modules that mutually import each other?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#import-‘x-y-z’-returns-lt-module-‘x’-gt-how-do-I-get-z"><span class="toc-number">1.25.</span> <span class="toc-text">__import__(‘x.y.z’) returns &lt;module ‘x’&gt;; how do I get z?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#When-I-edit-an-imported-module-and-reimport-it-the-changes-don’t-show-up-Why-does-this-happen-¶"><span class="toc-number">1.26.</span> <span class="toc-text">When I edit an imported module and reimport it, the changes don’t show up. Why does this happen?¶</span></a></li></ol></li></ol></div></div><div class="post-content"><p>来源于python文档的<a href="https://docs.python.org/3/faq/programming.html" target="_blank" rel="noopener"><code>Programmming FAQ</code></a>, 单纯的翻译过来, 有些地方还需要进一步深入.</p>
<h2 id="Core-Language"><a href="#Core-Language" class="headerlink" title="Core Language"></a>Core Language</h2><h3 id="why-am-i-getting-an-UnboundLocalError-when-the-cariable-has-a-value"><a href="#why-am-i-getting-an-UnboundLocalError-when-the-cariable-has-a-value" class="headerlink" title="why am i getting an UnboundLocalError when the cariable has a value?"></a>why am i getting an <code>UnboundLocalError</code> when the cariable has a value?</h3><p>TODO: <a href="https://www.python.org/dev/peps/pep-3104/" target="_blank" rel="noopener">Access to Names in Outer Scopes</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: x = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: <span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">()</span>:</span></span><br><span class="line">   ...:     print(x)</span><br><span class="line">   ...:</span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: bar()</span><br><span class="line"><span class="number">10</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">4</span>]: <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">   ...:     print(x)</span><br><span class="line">   ...:     x+=<span class="number">1</span></span><br><span class="line">   ...:</span><br><span class="line"></span><br><span class="line">In [<span class="number">5</span>]: foo()</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">UnboundLocalError                         Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-5</span>-c19b6d9633cf&gt; <span class="keyword">in</span> &lt;module&gt;()</span><br><span class="line">----&gt; 1 foo()</span><br><span class="line"></span><br><span class="line">&lt;ipython-input<span class="number">-4</span>-baf15b7aced1&gt; <span class="keyword">in</span> foo()</span><br><span class="line">      <span class="number">1</span> <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">----&gt; 2     print(x)</span><br><span class="line">      <span class="number">3</span>     x+=<span class="number">1</span></span><br><span class="line">      <span class="number">4</span></span><br><span class="line"></span><br><span class="line">UnboundLocalError: local variable <span class="string">'x'</span> referenced before assignment</span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">   ...:     print(x)</span><br><span class="line">   ...:     x= x+<span class="number">1</span></span><br><span class="line">   ...:</span><br><span class="line">   ...:</span><br><span class="line"></span><br><span class="line">In [<span class="number">7</span>]: foo()</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">UnboundLocalError                         Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-7</span>-c19b6d9633cf&gt; <span class="keyword">in</span> &lt;module&gt;()</span><br><span class="line">----&gt; 1 foo()</span><br><span class="line"></span><br><span class="line">&lt;ipython-input<span class="number">-6</span><span class="number">-1</span>fe44c88aa4d&gt; <span class="keyword">in</span> foo()</span><br><span class="line">      <span class="number">1</span> <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">----&gt; 2     print(x)</span><br><span class="line">      <span class="number">3</span>     x= x+<span class="number">1</span></span><br><span class="line">      <span class="number">4</span></span><br><span class="line">      <span class="number">5</span></span><br><span class="line"></span><br><span class="line">UnboundLocalError: local variable <span class="string">'x'</span> referenced before assignment</span><br></pre></td></tr></table></figure>
<p>可以理解为, 当你对作用域中的变量进行赋值的时候, 这个变量将作为该作用域的局部变量, 并在外部作用域中对任何具有相同名称的变量进行屏蔽.<br>在后俩失败的<code>foo()</code>函数中, 由于要对<code>x</code>进行赋值, 编译器就认为<code>x</code>是一个局部变量, 但是你在函数中并没有对x进行声明, 所以就报错咯</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">In [<span class="number">1</span>]: x = <span class="number">1</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">   ...:     print(x)</span><br><span class="line">   ...:     n = x + <span class="number">1</span></span><br><span class="line">   ...:     print(x)</span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: foo()</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">4</span>]: <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    print(x)</span><br><span class="line">    n = x + <span class="number">1</span></span><br><span class="line">    print(n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In [<span class="number">5</span>]: foo()</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">    print(x)</span><br><span class="line">    n = x + <span class="number">1</span></span><br><span class="line">    print(n)</span><br><span class="line">    x -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">7</span>]: foo()</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">UnboundLocalError                         Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-7</span><span class="number">-624891</span>b0d01a&gt; <span class="keyword">in</span> &lt;module&gt;()</span><br><span class="line">----&gt; 1 foo()</span><br><span class="line"></span><br><span class="line">&lt;ipython-input<span class="number">-6</span><span class="number">-2374</span>c4171c35&gt; <span class="keyword">in</span> foo()</span><br><span class="line">      <span class="number">1</span> <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">()</span>:</span></span><br><span class="line">----&gt; 2     print(x)</span><br><span class="line">      <span class="number">3</span>     n = x + <span class="number">1</span></span><br><span class="line">      <span class="number">4</span>     print(n)</span><br><span class="line">      <span class="number">5</span>     x -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">UnboundLocalError: local variable <span class="string">'x'</span> referenced before assignment</span><br></pre></td></tr></table></figure>
<ul>
<li>TODO: </li>
</ul>
<p>在python中, 每一个对象创建的时候, 都有一个标示, 也就是变量的名称, 一个类型和一个值.</p>
<p>可不可以理解为, <code>x = x + 1</code>是: 新建一个变量x, 这时候x已经覆盖了外部的x变量, 但是还没有赋值,然后等号右边对x进行赋值, 这时候x是一个声明但没有赋值的对象, 然后就报错???</p>
<p>那如果我想在函数中对全局变量操作个需要怎么办?</p>
<ul>
<li>利用<code>golbal</code>关键字</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">15</span>]: x</span><br><span class="line">Out[<span class="number">15</span>]: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">16</span>]: <span class="function"><span class="keyword">def</span> <span class="title">fooa</span><span class="params">()</span>:</span></span><br><span class="line">   ....:     <span class="keyword">global</span> x</span><br><span class="line">   ....:     print(x)</span><br><span class="line">   ....:     x += <span class="number">1</span></span><br><span class="line">   ....:     print(x)</span><br><span class="line">   ....:     </span><br><span class="line"></span><br><span class="line">In [<span class="number">17</span>]: fooa()</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">18</span>]: x</span><br><span class="line">Out[<span class="number">18</span>]: <span class="number">2</span></span><br></pre></td></tr></table></figure>
<ul>
<li>利用<code>nonlocal</code>关键字</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">10</span>]: <span class="function"><span class="keyword">def</span> <span class="title">foobar</span><span class="params">()</span>:</span></span><br><span class="line">   ....:     x = <span class="number">10</span></span><br><span class="line">   ....:     <span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">()</span>:</span></span><br><span class="line">   ....:         <span class="keyword">nonlocal</span> x</span><br><span class="line">   ....:         print(x)</span><br><span class="line">   ....:         x += <span class="number">1</span></span><br><span class="line">   ....:     bar()</span><br><span class="line">   ....:     print(x)</span><br><span class="line">   ....:     </span><br><span class="line"></span><br><span class="line">In [<span class="number">11</span>]: foobar()</span><br><span class="line"><span class="number">10</span></span><br><span class="line"><span class="number">11</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">13</span>]: <span class="function"><span class="keyword">def</span> <span class="title">foobar</span><span class="params">()</span>:</span></span><br><span class="line">    x = <span class="number">10</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="comment">#nonlocal x</span></span><br><span class="line">        print(x)</span><br><span class="line">        x += <span class="number">1</span></span><br><span class="line">    bar()</span><br><span class="line">    print(x) </span><br><span class="line"></span><br><span class="line">In [<span class="number">14</span>]: foobar()</span><br><span class="line"></span><br><span class="line">UnboundLocalError: local variable <span class="string">'x'</span> referenced before assignment</span><br><span class="line"></span><br><span class="line">In [<span class="number">22</span>]: x</span><br><span class="line">Out[<span class="number">22</span>]: <span class="number">2</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">23</span>]: <span class="function"><span class="keyword">def</span> <span class="title">foobar</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> x</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">bar</span><span class="params">()</span>:</span></span><br><span class="line">        <span class="keyword">nonlocal</span> x</span><br><span class="line">        print(x)</span><br><span class="line">        x = <span class="number">3</span></span><br><span class="line">    bar()</span><br><span class="line">    print(x)</span><br><span class="line"></span><br><span class="line">SyntaxError: no binding <span class="keyword">for</span> <span class="keyword">nonlocal</span> <span class="string">'x'</span> found</span><br><span class="line"><span class="comment"># nonlocal不能和global绑定的名称重复</span></span><br></pre></td></tr></table></figure>
<h3 id="What-are-the-rules-for-local-and-global-variables-in-Python"><a href="#What-are-the-rules-for-local-and-global-variables-in-Python" class="headerlink" title="What are the rules for local and global variables in Python"></a>What are the rules for local and global variables in Python</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">27</span>]: <span class="function"><span class="keyword">def</span> <span class="title">fooa</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">global</span> p    </span><br><span class="line">    print(p)</span><br><span class="line">    p += <span class="number">1</span></span><br><span class="line">    print(p)</span><br><span class="line">   ....:     </span><br><span class="line"></span><br><span class="line">In [<span class="number">28</span>]: fooa()</span><br><span class="line">NameError: name <span class="string">'p'</span> <span class="keyword">is</span> <span class="keyword">not</span> defined</span><br></pre></td></tr></table></figure>
<p>在Python中，仅在函数内引用的变量隐式地为全局变量。 如果一个变量在函数体内的任何位置被赋值，它被认为是一个局部变量，除非明确声明为全局变量。</p>
<p>尽管起初有点令人惊讶，但一时的考虑解释了这一点。 一方面，要求分配变量的全局值可以防止出现意想不到的副作用。 另一方面，如果所有全局引用都需要全局，则您将始终使用全局。 您必须声明为全局的每个对内置函数的引用或对导入模块的组件。 这种混乱将破坏全球声明确定副作用的有效性。</p>
<h3 id="Why-do-lambdas-defined-in-a-loop-with-different-values-all-return-the-same-result"><a href="#Why-do-lambdas-defined-in-a-loop-with-different-values-all-return-the-same-result" class="headerlink" title="Why do lambdas defined in a loop with different values all return the same result?"></a>Why do lambdas defined in a loop with different values all return the same result?</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">29</span>]: squares = []</span><br><span class="line"></span><br><span class="line">In [<span class="number">30</span>]: <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">   ....:     squares.append(<span class="keyword">lambda</span>: x**<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">31</span>]: squares</span><br><span class="line">Out[<span class="number">31</span>]: </span><br><span class="line">[&lt;function __main__.&lt;<span class="keyword">lambda</span>&gt;&gt;,</span><br><span class="line"> &lt;function __main__.&lt;<span class="keyword">lambda</span>&gt;&gt;,</span><br><span class="line"> &lt;function __main__.&lt;<span class="keyword">lambda</span>&gt;&gt;,</span><br><span class="line"> &lt;function __main__.&lt;<span class="keyword">lambda</span>&gt;&gt;]</span><br><span class="line"></span><br><span class="line">In [<span class="number">32</span>]: squares[<span class="number">2</span>]()</span><br><span class="line">Out[<span class="number">32</span>]: <span class="number">9</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">34</span>]: squares[<span class="number">3</span>]()</span><br><span class="line">Out[<span class="number">34</span>]: <span class="number">9</span></span><br></pre></td></tr></table></figure>
<p>上面会隐式的创建一个变量x:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: squares = []</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">4</span>):</span><br><span class="line">    squares.append(<span class="keyword">lambda</span>: x**<span class="number">2</span>)</span><br><span class="line">   ...:     </span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: x</span><br><span class="line">Out[<span class="number">3</span>]: <span class="number">3</span></span><br></pre></td></tr></table></figure>
<p>x不是lambda函数内部的变量, 而是在外部定义的, 然后x最终的值是3, 所以所有的函数都返回3**2:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">35</span>]: x = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">36</span>]: squares[<span class="number">3</span>]()</span><br><span class="line">Out[<span class="number">36</span>]: <span class="number">100</span></span><br></pre></td></tr></table></figure>
<p>如果想要值改变, 可以声明一个新的变量n, 然后将x的值赋给n:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>squares = []</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line"><span class="meta">... </span>    squares.append(<span class="keyword">lambda</span> n=x: n**<span class="number">2</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="How-do-I-share-global-variables-across-modules"><a href="#How-do-I-share-global-variables-across-modules" class="headerlink" title="How do I share global variables across modules?"></a>How do I share global variables across modules?</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># config.py</span></span><br><span class="line">x = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mod.py</span></span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line">config.x = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># main.py</span></span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line"><span class="keyword">import</span> mod</span><br><span class="line">print(config.x) <span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># main2.py</span></span><br><span class="line"><span class="keyword">import</span> config</span><br><span class="line">print(config.x) <span class="comment"># return  0</span></span><br></pre></td></tr></table></figure>
<h3 id="Why-are-default-values-shared-between-objects"><a href="#Why-are-default-values-shared-between-objects" class="headerlink" title="Why are default values shared between objects?"></a>Why are default values shared between objects?</h3><p>考虑一个不看文档的人或者大神写的一个函数:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">9</span>]: <span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(a, b=[])</span>:</span></span><br><span class="line">   ...:     <span class="keyword">for</span> i <span class="keyword">in</span> range(a):</span><br><span class="line">   ...:         b.append(i**<span class="number">2</span>)</span><br><span class="line">   ...:     print(b)</span><br><span class="line"></span><br><span class="line">In [<span class="number">10</span>]: foo(<span class="number">3</span>)</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">11</span>]: foo(<span class="number">3</span>, [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>])</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">12</span>]: foo(<span class="number">4</span>)</span><br><span class="line">[<span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">help(foo)</span><br><span class="line"></span><br><span class="line">Help on function foo <span class="keyword">in</span> module __main__:</span><br><span class="line"></span><br><span class="line">foo(a, b=[<span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">4</span>, <span class="number">9</span>])</span><br></pre></td></tr></table></figure>
<p>看到了没, 当调用两次foo后, b的默认值已经变为了一大堆. </p>
<p>这是因为, 在python中, 当函数定义后, 默认值只创建一次, 如果默认值对象发生改变, 那么该函数的后续调用将引用这个已经更改的<br>对象.</p>
<p>根据定义, 诸如数字, 字符串, 元祖和None等不可变对象可以免于更改. 对于可变对象, 例如字典或者列表, 类实例等<br>的更改可能会导致混淆.</p>
<p>所以, 使用不可变对象作为默认值是一个好习惯, 所以上面可以写为:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(a=<span class="number">0</span>, b=None)</span>:</span></span><br><span class="line">    b = []</span><br><span class="line">    ...</span><br><span class="line">    print(b)</span><br></pre></td></tr></table></figure>
<p>也不是说说上面第一个写的一定是错的, 存在即是合理对吧, 你可以用这个特性做一些好玩的事情, 比如<br>写一个函数的缓存:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span><span class="params">(arg1, arg2, _cache=&#123;&#125;)</span>:</span></span><br><span class="line">    cache_key = cache_key_func(*args)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> _cache[<span class="string">"cache_key"</span>]</span><br><span class="line">    expect KeyError:</span><br><span class="line">        response = func(*args)</span><br><span class="line">        _cache[<span class="string">'cache_key'</span>] = response</span><br><span class="line">        <span class="keyword">return</span> _cache[<span class="string">"cache_key"</span>]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">raise</span></span><br></pre></td></tr></table></figure>
<p>当然, 你也可以声明一~个全局变量做这些事情, 这么写没有对错, 你高兴就好.</p>
<h3 id="How-can-i-pass-optional-or-keyword-parameters-from-one-func-to-another"><a href="#How-can-i-pass-optional-or-keyword-parameters-from-one-func-to-another" class="headerlink" title="How can i pass optional or keyword parameters from one func to another?"></a>How can i pass optional or keyword parameters from one func to another?</h3><p>你可以用<code>*arg</code>和<code>**kwargs</code>两个关键字啦，</p>
<ul>
<li><code>*args</code>将位置参数作为一个tuple传进来</li>
<li><code>**kwagrs</code>将参数作为一个字典传进来</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">f</span><span class="params">(x, *args, **kwargs)</span>:</span></span><br><span class="line">    kwargs[<span class="string">"width"</span>] = <span class="string">"23.1"</span></span><br><span class="line">    ...</span><br><span class="line">    g(x, *args, **kwargs)</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<p>上面这个, 神似装饰器吧, 其实装饰器也就这个作用</p>
<h3 id="What-is-the-difference-between-arguments-and-parameters"><a href="#What-is-the-difference-between-arguments-and-parameters" class="headerlink" title="What is the difference between arguments and parameters?"></a>What is the difference between arguments and parameters?</h3><ul>
<li>parameters 是定义在函数中使用到的参数的名字, 或者说是参数的类型</li>
<li>arguments 是实际传入的value</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(foo, bar=None, **kwars)</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line">func(<span class="number">32</span>, bar=<span class="number">33</span>, extra=somevar)</span><br></pre></td></tr></table></figure>
<p>上面中, foo, bar, kwargs是parameters, 32, 33, somevae是arguments</p>
<h3 id="Why-did-changing-list-‘y’-also-change-list-‘x’"><a href="#Why-did-changing-list-‘y’-also-change-list-‘x’" class="headerlink" title="Why did changing list ‘y’ also change list ‘x’?"></a>Why did changing list ‘y’ also change list ‘x’?</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">18</span>]: x = []</span><br><span class="line"></span><br><span class="line">In [<span class="number">19</span>]: y= x</span><br><span class="line"></span><br><span class="line">In [<span class="number">20</span>]: x.append(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">21</span>]: y</span><br><span class="line">Out[<span class="number">21</span>]: [<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">22</span>]: x</span><br><span class="line">Out[<span class="number">22</span>]: [<span class="number">2</span>]</span><br></pre></td></tr></table></figure>
<p>导致这个问题有两个原因:</p>
<ul>
<li><ol>
<li>变量仅仅是一个对象引用的名字, 当执行<code>y=x</code>的时候, 并没有创建一个list的复制, 而是创建了一个新de<br>引用, 这个引用就是x引用的那个对象, 也就是说, xy都指向相同的一个对象, id是相同的</li>
</ol>
</li>
<li><p>2.lists是可变的, 也就是说, 可以改变他们的内容</p>
<p>再看一个例子:</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"> In [<span class="number">28</span>]: x = <span class="number">5</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">29</span>]: y = x</span><br><span class="line"></span><br><span class="line">In [<span class="number">30</span>]: x = <span class="number">6</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">31</span>]: y</span><br><span class="line">Out[<span class="number">31</span>]: <span class="number">5</span></span><br></pre></td></tr></table></figure>
<p>这是因为integers是不可变对象, 当我们执行<code>x=6</code>的时候不是将整数5更新为6, 而是创建<br>了一个新的整数对象, 值是6, 然后把它赋值给x, 也就是说现在我们总共创建了两个对象, 然后xy两个对象<br>分别引用不同的对象:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">32</span>]: id(x)</span><br><span class="line">Out[<span class="number">32</span>]: <span class="number">10919584</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">33</span>]: id(y)</span><br><span class="line">Out[<span class="number">33</span>]: <span class="number">10919552</span></span><br></pre></td></tr></table></figure>
<p>一些行为, 例如<code>y.append(10)</code>或者<code>y.sort()</code>会在原有的对象上进行更改, 但是<br>一些相似的行为会创建一个新的对象, 例如<code>y = y + [1,2,3]</code>或者<code>sorted(y)</code>,<br>一个简单的方法分辨这两种对象是根据返回值来判断, 如果这个操作返回的是<code>None</code>, 那么<br>就是在原有的对象上进行的操作.</p>
<p>总的来说:</p>
<ul>
<li><p>如果对可变对象进行操作, 我们可以用一些特定的操作来更新它然后让所有的对象都看到相同的value</p>
</li>
<li><p>对于不可变对象, 例如<code>int</code>, <code>str</code>, <code>tuple</code>等, 所有引用它的变量都能看到相同的值, 但是更新这个对象的操作总会<br>返回一个新的对象</p>
</li>
</ul>
<p>###　How do I write a function with output parameters (call by reference)?</p>
<p>记住, 在python中, 是参数是通过赋值传递的, 也就是说, 参数传进来的只是一个value,<br>由于赋值只是创建对象的引用，所以在调用者和被调用者之间的参数名称之间没有别名，因此没有本身的引用调用。 您可以通过多种方式达到预期效果。</p>
<ul>
<li>by returning a typle of the results:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    a = <span class="string">"new_value"</span></span><br><span class="line">    b = b + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> a, b</span><br><span class="line"></span><br><span class="line">x, y = <span class="string">"old-value"</span>, <span class="number">99</span></span><br><span class="line">x, y = func(x, y)</span><br><span class="line">print(x, y) <span class="comment"># new_value, 100</span></span><br></pre></td></tr></table></figure>
<p>这个是最清晰也是最常用的方法</p>
<ul>
<li><p>通过全局变量, 但是这个不是线性安全的, 不推荐</p>
</li>
<li><p>通过传递一个可变对象</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">39</span>]: <span class="function"><span class="keyword">def</span> <span class="title">func</span><span class="params">(a)</span>:</span></span><br><span class="line">   ....:     a.append(<span class="number">2</span>)</span><br><span class="line">   ....:     </span><br><span class="line"></span><br><span class="line">In [<span class="number">40</span>]: a</span><br><span class="line">Out[<span class="number">40</span>]: []</span><br><span class="line"></span><br><span class="line">In [<span class="number">41</span>]: func(a)</span><br><span class="line"></span><br><span class="line">In [<span class="number">42</span>]: a</span><br><span class="line">Out[<span class="number">42</span>]: [<span class="number">2</span>]</span><br></pre></td></tr></table></figure>
<ul>
<li>传入一个字典更改</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func3</span><span class="params">(args)</span>:</span></span><br><span class="line">    args[<span class="string">'a'</span>] = <span class="string">'new-value'</span>     <span class="comment"># args is a mutable dictionary</span></span><br><span class="line">    args[<span class="string">'b'</span>] = args[<span class="string">'b'</span>] + <span class="number">1</span>   <span class="comment"># change it in-place</span></span><br><span class="line"></span><br><span class="line">args = &#123;<span class="string">'a'</span>: <span class="string">'old-value'</span>, <span class="string">'b'</span>: <span class="number">99</span>&#125;</span><br><span class="line">func3(args)</span><br><span class="line">print(args[<span class="string">'a'</span>], args[<span class="string">'b'</span>])</span><br></pre></td></tr></table></figure>
<ul>
<li>把参数当成类的属性:</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这个方法貌似在django的中间件还是哪里用过</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">callByRef</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, **args)</span>:</span></span><br><span class="line">        <span class="keyword">for</span> (key, value) <span class="keyword">in</span> args.items():</span><br><span class="line">            setattr(self, key, value)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">func4</span><span class="params">(args)</span>:</span></span><br><span class="line">    args.a = <span class="string">'new-value'</span>        <span class="comment"># args is a mutable callByRef</span></span><br><span class="line">    args.b = args.b + <span class="number">1</span>         <span class="comment"># change object in-place</span></span><br><span class="line"></span><br><span class="line">args = callByRef(a=<span class="string">'old-value'</span>, b=<span class="number">99</span>)</span><br><span class="line">func4(args)</span><br><span class="line">print(args.a, args.b)</span><br></pre></td></tr></table></figure>
<h3 id="How-do-you-make-a-higher-order-function-in-Python"><a href="#How-do-you-make-a-higher-order-function-in-Python" class="headerlink" title="How do you make a higher order function in Python?"></a>How do you make a higher order function in Python?</h3><p>你可以创建一个嵌套的作用域或者利用python的<code>__call__(self)</code>方法:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 嵌套作用域, 装饰器啦</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">linear</span><span class="params">(a ,b)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">result</span><span class="params">(x)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> a*x + b</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment"># __call__方法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Linear</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(a, b)</span>:</span></span><br><span class="line">        self.a, self.b = a, b</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> self.a*x + self.b</span><br><span class="line"></span><br><span class="line">dd = Linear(<span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">dd(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p>TODO: 对象可以封装几种方法的状态, 这句看不懂什么意思</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span>:</span></span><br><span class="line">    </span><br><span class="line">    value = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">up</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.value += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">sets</span><span class="params">(self, x)</span>:</span></span><br><span class="line">        self.value = x</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">down</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.value -= <span class="number">1</span></span><br><span class="line">count = Counter()</span><br><span class="line">sets, up, down = count.sets, up, down <span class="comment"># 在scrapy的download middleware中, 就是这么处理的</span></span><br></pre></td></tr></table></figure>
<h3 id="How-do-I-copy-an-object-in-Python"><a href="#How-do-I-copy-an-object-in-Python" class="headerlink" title="How do I copy an object in Python?"></a>How do I copy an object in Python?</h3><p>通常的, 可以试着用<code>copy()</code>或者<code>deepcopy()</code>方法:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">newdict = olddict.copy()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对于序列对象还可以用索引来做</span></span><br><span class="line">new_list = oldlist[:]</span><br></pre></td></tr></table></figure>
<h3 id="Is-there-an-equivalent-of-C’s-“-”-ternary-operator"><a href="#Is-there-an-equivalent-of-C’s-“-”-ternary-operator" class="headerlink" title="Is there an equivalent of C’s “?:” ternary operator ?"></a>Is there an equivalent of C’s “?:” ternary operator ?</h3><p>在python中有这样的定义:<code>on_true if expression else on_false</code>:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">x, y = <span class="number">10</span>, <span class="number">20</span></span><br><span class="line">small = x <span class="keyword">if</span> x &lt; y <span class="keyword">else</span> y</span><br></pre></td></tr></table></figure>
<p>但是, 这么做可能会引发一些问题, 尤其是当前面的x返回的不是bool而是一些异常的时候, 所以最好用<code>...if ...slse..</code>这种形式</p>
<h3 id="How-do-i-modify-a-string-in-place"><a href="#How-do-i-modify-a-string-in-place" class="headerlink" title="How do i modify a string in place?"></a>How do i modify a string in place?</h3><p>you can’t, because strings are immutable. In most situations, you should simply construct a<br>new strings from the various parts you want to assemble it from,<br>但是如果你想原址的修改<code>unicode</code>对象, 那么可以试试<code>io.StringIO</code>模块或者<code>array</code>模块:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">1</span>]: <span class="keyword">import</span> io</span><br><span class="line"></span><br><span class="line">In [<span class="number">2</span>]: s = <span class="string">"hellow world"</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">3</span>]: sio = io.StringIO(s)</span><br><span class="line"></span><br><span class="line">In [<span class="number">4</span>]: sio</span><br><span class="line">Out[<span class="number">4</span>]: &lt;_io.StringIO at <span class="number">0x1dbd77b6f78</span>&gt;</span><br><span class="line"></span><br><span class="line">In [<span class="number">5</span>]: sio.getvalue()</span><br><span class="line">Out[<span class="number">5</span>]: <span class="string">'hellow world'</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">6</span>]: sio.seek()</span><br><span class="line">---------------------------------------------------------------------------</span><br><span class="line">TypeError                                 Traceback (most recent call last)</span><br><span class="line">&lt;ipython-input<span class="number">-6</span><span class="number">-0007</span>ce4a479a&gt; <span class="keyword">in</span> &lt;module&gt;()</span><br><span class="line">----&gt; 1 sio.seek()</span><br><span class="line"></span><br><span class="line">TypeError: seek() takes at least <span class="number">1</span> argument (<span class="number">0</span> given)</span><br><span class="line"></span><br><span class="line">In [<span class="number">7</span>]: sio.seek(<span class="number">3</span>)</span><br><span class="line">Out[<span class="number">7</span>]: <span class="number">3</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">8</span>]: sio.write(<span class="string">"there"</span>)</span><br><span class="line">Out[<span class="number">8</span>]: <span class="number">5</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">9</span>]: sio.getvalue()</span><br><span class="line">Out[<span class="number">9</span>]: <span class="string">'helthereorld'</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">10</span>]: <span class="keyword">import</span> array</span><br><span class="line"></span><br><span class="line">In [<span class="number">11</span>]: a = array.array(<span class="string">"u"</span>, s)</span><br><span class="line"></span><br><span class="line">In [<span class="number">12</span>]: print(a)</span><br><span class="line">array(<span class="string">'u'</span>, <span class="string">'hellow world'</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">13</span>]: a[<span class="number">0</span>] = <span class="string">"y"</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">14</span>]: print(a)</span><br><span class="line">array(<span class="string">'u'</span>, <span class="string">'yellow world'</span>)</span><br><span class="line"></span><br><span class="line">In [<span class="number">15</span>]: a.tounicode()</span><br><span class="line">Out[<span class="number">15</span>]: <span class="string">'yellow world'</span></span><br></pre></td></tr></table></figure>
<h3 id="How-do-I-use-strings-to-call-functions-methods"><a href="#How-do-I-use-strings-to-call-functions-methods" class="headerlink" title="How do I use strings to call functions/methods?"></a>How do I use strings to call functions/methods?</h3><p>这个方法就多了:</p>
<ol>
<li>最好的方法是用一个字典映射字符串和函数, 这种方法好的一点是不用一定将字符串<br>和函数名字一样:</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">a</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">b</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">dispath = &#123;<span class="string">"go"</span>:a, <span class="string">"stop"</span>:b&#125;</span><br><span class="line">dispath[get_input()]() <span class="comment"># 执行输入的字符串那个函数</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>用内置的函数<code>getattr()</code></li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> foo</span><br><span class="line">getattr(foo, <span class="string">"bar"</span>)</span><br></pre></td></tr></table></figure>
<p>请注意，getattr（）适用于任何对象，包括类，类实例，模块等。</p>
<p>这用于标准库中的几个地方，如下所示：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">do_foo</span><span class="params">(self)</span>:</span></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">do_bar</span><span class="params">(self)</span>:</span></span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">f = getattr(foo_instance, <span class="string">"do_"</span>+opname)</span><br><span class="line">f()</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>用<code>locals()</code>或者<code>eval()</code>函数</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myfunc</span><span class="params">()</span>:</span></span><br><span class="line">    print(<span class="string">"hello"</span>)</span><br><span class="line"></span><br><span class="line">fname = <span class="string">"myfunc"</span></span><br><span class="line">f = locals()[fname]</span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="string">In [21]: help(locals)</span></span><br><span class="line"><span class="string">Help on built-in function locals in module builtins:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">locals()</span></span><br><span class="line"><span class="string">    Return a dictionary containing the current scope's local variables.</span></span><br><span class="line"><span class="string">    # 返回包含当前作用域局部变量的字典。</span></span><br><span class="line"><span class="string">    NOTE: Whether or not updates to this dictionary will affect name lookups in</span></span><br><span class="line"><span class="string">    the local scope and vice-versa is *implementation dependent* and not</span></span><br><span class="line"><span class="string">    covered by any backwards compatibility guarantees.</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">In [<span class="number">22</span>]: f = eval(fname)</span><br><span class="line"></span><br><span class="line">In [<span class="number">23</span>]: f</span><br><span class="line">Out[<span class="number">23</span>]: &lt;function __main__.myfunc&gt;</span><br><span class="line"></span><br><span class="line">In [<span class="number">24</span>]: f()</span><br><span class="line">hello</span><br><span class="line"></span><br><span class="line">In [<span class="number">25</span>]: help(eval)</span><br><span class="line">Help on built-<span class="keyword">in</span> function eval <span class="keyword">in</span> module builtins:</span><br><span class="line"></span><br><span class="line">eval(source, globals=<span class="keyword">None</span>, locals=<span class="keyword">None</span>, /)</span><br><span class="line">    Evaluate the given source <span class="keyword">in</span> the context of globals <span class="keyword">and</span> locals.</span><br><span class="line"></span><br><span class="line">    The source may be a string representing a Python expression</span><br><span class="line">    <span class="keyword">or</span> a code object <span class="keyword">as</span> returned by compile().</span><br><span class="line">    The globals must be a dictionary <span class="keyword">and</span> locals can be any mapping,</span><br><span class="line">    defaulting to the current globals <span class="keyword">and</span> locals.</span><br><span class="line">    If only globals <span class="keyword">is</span> given, locals defaults to it.</span><br></pre></td></tr></table></figure>
<p>虽然说存在即是合理, 但是不知道在哪里用<code>eval</code>这个函数, 不推荐用</p>
<h3 id="What-is-the-most-efficient-way-to-concatenate-many-strings-together"><a href="#What-is-the-most-efficient-way-to-concatenate-many-strings-together" class="headerlink" title="What is the most efficient way to concatenate many strings together?"></a>What is the most efficient way to concatenate many strings together?</h3><p>str和bytes对象是不可变的，因此将许多字符串连接在一起效率不高，因为每个连接都会创建一个新对象。 在一般情况下，总运行时间成本在总字符串长度中是二次方的。</p>
<p>To accumulate many str objects, the recommended idiom is to place them into a list and call str.join() at the end:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">chunks = []</span><br><span class="line"><span class="keyword">for</span> s <span class="keyword">in</span> my_strings:</span><br><span class="line">    chunks.append(s)</span><br><span class="line">result = <span class="string">''</span>.join(chunks)</span><br><span class="line"><span class="comment"># 当然, 别忘了`io.StringIO`这个模块</span></span><br></pre></td></tr></table></figure></p>
<p>To accumulate many bytes objects, the recommended idiom is to extend a bytearray object using in-place concatenation (the += operator):<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">result = bytearray()</span><br><span class="line"><span class="keyword">for</span> b <span class="keyword">in</span> my_bytes_objects:</span><br><span class="line">    result += b</span><br></pre></td></tr></table></figure></p>
<h3 id="How-do-I-iterate-over-a-sequence-in-reverse-order"><a href="#How-do-I-iterate-over-a-sequence-in-reverse-order" class="headerlink" title="How do I iterate over a sequence in reverse order?"></a>How do I iterate over a sequence in reverse order?</h3><ol>
<li><code>reversed()</code>函数</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> reversed(sequence):</span><br><span class="line">    ... <span class="comment"># do somethings with x</span></span><br></pre></td></tr></table></figure>
<ol start="2">
<li>利用序列的索引</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> sequence[::<span class="number">-1</span>]:</span><br><span class="line">    ... <span class="comment"># do somethings with x</span></span><br></pre></td></tr></table></figure>
<h3 id="How-do-you-remove-duplicates-from-a-list"><a href="#How-do-you-remove-duplicates-from-a-list" class="headerlink" title="How do you remove duplicates from a list?"></a>How do you remove duplicates from a list?</h3><p>如果不关心原来列表的顺序, 那么可以先对列表排序然后删除重复的value:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> mylist:</span><br><span class="line">    mylist.sort()</span><br><span class="line">    last = mylist[<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(mylist)<span class="number">-2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        <span class="keyword">if</span> last == mylist[i]:</span><br><span class="line">            <span class="keyword">del</span> mylist[i]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            last = mylist[i]</span><br></pre></td></tr></table></figure>
<p>如果列表中所有的value都是<code>hashable</code>的, 那么可以直接调用<code>mylist = list(set(mylist))</code></p>
<h3 id="How-do-you-make-an-array-in-Python"><a href="#How-do-you-make-an-array-in-Python" class="headerlink" title="How do you make an array in Python?"></a>How do you make an array in Python?</h3><p>用列表代替啦, python的列表和c的不同在于, python的列表中的项可以是不同的类型. </p>
<p>当然, 也可以用内置的<code>array</code>模块来创建一个数组, 但是它的索引会比list慢.</p>
<h3 id="How-do-I-create-a-multidimensional-list"><a href="#How-do-I-create-a-multidimensional-list" class="headerlink" title="How do I create a multidimensional list?"></a>How do I create a multidimensional list?</h3><p>你肯定会想到这种骚操作:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">26</span>]: a = [[<span class="keyword">None</span>] * <span class="number">2</span>] * <span class="number">3</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">27</span>]: a</span><br><span class="line">Out[<span class="number">27</span>]: [[<span class="keyword">None</span>, <span class="keyword">None</span>], [<span class="keyword">None</span>, <span class="keyword">None</span>], [<span class="keyword">None</span>, <span class="keyword">None</span>]]</span><br><span class="line"></span><br><span class="line">In [<span class="number">28</span>]: a[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">2</span></span><br><span class="line"></span><br><span class="line">In [<span class="number">29</span>]: a</span><br><span class="line">Out[<span class="number">29</span>]: [[<span class="number">2</span>, <span class="keyword">None</span>], [<span class="number">2</span>, <span class="keyword">None</span>], [<span class="number">2</span>, <span class="keyword">None</span>]]</span><br></pre></td></tr></table></figure></p>
<p>很伤心对吧, 直到为啥吗?<br>原因是用<code>*</code>复制列表不会创建副本，它只会创建对现有对象的引用。<br><code>* 3</code>创建一个列表，其中包含3个对长度为2的相同列表的引用。<br> 一行中的更改将显示在所有行中，这几乎肯定不是您想要的。</p>
<p>你知道有个库叫<code>numpy</code>吗? 不知道吧, 去看看吧!!!</p>
<h3 id="Why-does-a-tuple-i-‘item’-raise-an-exception-when-the-addition-works-¶"><a href="#Why-does-a-tuple-i-‘item’-raise-an-exception-when-the-addition-works-¶" class="headerlink" title="Why does a_tuple[i] += [‘item’] raise an exception when the addition works?¶"></a>Why does a_tuple[i] += [‘item’] raise an exception when the addition works?¶</h3><p>看看上面写的可变对象和不可变对象的区别, tuple是不可变对象, 所以用list代替吧</p>
<h3 id="How-can-I-sort-one-list-by-values-from-another-list"><a href="#How-can-I-sort-one-list-by-values-from-another-list" class="headerlink" title="How can I sort one list by values from another list?"></a>How can I sort one list by values from another list?</h3><p>把他们合并成一个元组, 然后对结果列表进行排序, 然后再解压</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">In [<span class="number">30</span>]: list1 = [<span class="string">"what"</span>, <span class="string">"I'm"</span>, <span class="string">"sorting"</span>, <span class="string">"by"</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">31</span>]: list2 = [<span class="string">"something"</span>, <span class="string">"else"</span>, <span class="string">"to"</span>, <span class="string">"sort"</span>]</span><br><span class="line"></span><br><span class="line">In [<span class="number">32</span>]: pairs = zip(list1, list2)</span><br><span class="line"></span><br><span class="line">In [<span class="number">33</span>]: pairs = sorted(pairs)</span><br><span class="line"></span><br><span class="line">In [<span class="number">34</span>]: pairs</span><br><span class="line">Out[<span class="number">34</span>]: [(<span class="string">"I'm"</span>, <span class="string">'else'</span>), (<span class="string">'by'</span>, <span class="string">'sort'</span>), (<span class="string">'sorting'</span>, <span class="string">'to'</span>), (<span class="string">'what'</span>, <span class="string">'something'</span>)]</span><br><span class="line"></span><br><span class="line">In [<span class="number">35</span>]: result = [x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> pairs]</span><br><span class="line"></span><br><span class="line">In [<span class="number">36</span>]: result</span><br><span class="line">Out[<span class="number">36</span>]: [<span class="string">'else'</span>, <span class="string">'sort'</span>, <span class="string">'to'</span>, <span class="string">'something'</span>]</span><br></pre></td></tr></table></figure>
<p>An alternative for the last step is:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span>result = []</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">for</span> p <span class="keyword">in</span> pairs: result.append(p[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<p>如果你觉得这更清晰，你可能更喜欢用这个来代替最终的列表理解。<br>然而，长列表的速度几乎是其两倍。 为什么？<br>首先，<code>append()</code>操作必须重新分配内存，<br>并且尽管每次都使用一些技巧来避免这样做，但它仍然需要偶尔执行，<br>而且花费相当多。 其次，表达式<code>result.append</code>需要一个额外的属性查询，<br>第三，从完成所有这些函数调用中减少速度。</p>
<h3 id="My-class-defunes-del-but-it-is-not-called-when-i-delete-the-object"><a href="#My-class-defunes-del-but-it-is-not-called-when-i-delete-the-object" class="headerlink" title="My class defunes del but it is not called when i delete the object"></a>My class defunes <strong>del</strong> but it is not called when i delete the object</h3><p>这有几个可能的原因。</p>
<ol>
<li><p><code>del</code>语句不一定会调用<code>__del __()</code>, 它只是递减对象的引用计数，并且如果该值达到零，则调用<code>__del __()</code>。</p>
</li>
<li><p>如果您的数据结构包含循环链接（例如，每个孩子都有一个父引用并且每个父代都有一个孩子列表的树），<br>引用计数将永远不会回到零。偶尔，Python运行一种算法来检测这样的周期，<br>但是垃圾收集器可能会在最后一次对数据结构的引用消失后运行一段时间，因此可能会在不方便且随机的时间调用<code>__del __()</code>方法。<br>如果您试图重现问题，这很不方便。更糟糕的是，对象的<code>__del __()</code>方法的执行顺序是任意的。<br>您可以运行<code>gc.collect()</code>来强制收集，但有病理情况下永远不会收集对象。</p>
</li>
<li><p>尽管使用了循环收集器，但对于每次完成它们时要调用的对象定义一个明确的<code>close（）</code>方法仍然是一个好主意。 <code>close（）</code>方法可以删除引用子对象的属性。不要直接调用<code>__del __（）</code>, 应该调用<code>close（）</code>，<code>close（）</code>应该确保它可以针对同一个对象多次调用。</p>
</li>
<li><p>避免循环引用的另一种方法是使用<code>weakref</code>模块，它允许您在不增加引用计数的情况下指向对象。例如，树数据结构应该为它们的父代和兄弟引用使用弱引用（如果它们需要它们！）。</p>
</li>
<li><p>最后，如果<code>__del __（）</code>方法引发异常，则会向<code>sys.stderr</code>输出警告消息。</p>
</li>
</ol>
<h3 id="Why-does-the-result-of-id-appear-to-be-not-unique"><a href="#Why-does-the-result-of-id-appear-to-be-not-unique" class="headerlink" title="Why does the result of id() appear to be not unique?"></a>Why does the result of id() appear to be not unique?</h3><h3 id="How-do-I-find-the-current-module-name"><a href="#How-do-I-find-the-current-module-name" class="headerlink" title="How do I find the current module name?"></a>How do I find the current module name?</h3><p>模块可以通过查看预定义的全局变量<code>__name__</code>找出它自己的模块名称。 如果这个值为<code>&#39;__main__&#39;</code>，<br>程序将作为脚本运行。 通常通过导入它们的许多模块还提供命令行界面或自检，<br>并且只在检查<code>__name__</code>后执行此代码：</p>
<h3 id="How-can-I-have-modules-that-mutually-import-each-other"><a href="#How-can-I-have-modules-that-mutually-import-each-other" class="headerlink" title="How can I have modules that mutually import each other?"></a>How can I have modules that mutually import each other?</h3><p><strong>没写, 没心情了</strong></p>
<p>Suppose you have the following modules:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># foo.py:</span></span><br><span class="line"><span class="keyword">from</span> bar <span class="keyword">import</span> bar_var</span><br><span class="line">foo_var = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># bar.py:</span></span><br><span class="line"><span class="keyword">from</span> foo <span class="keyword">import</span> foo_var</span><br><span class="line">bar_var = <span class="number">2</span></span><br></pre></td></tr></table></figure>
<p>The problem is that the interpreter will perform the following steps:</p>
<ul>
<li>main imports <code>foo</code></li>
<li>Empty globals for <code>foo</code> are created</li>
<li><code>foo</code> is compiled and starts executing</li>
<li><code>foo</code> imports <code>bar</code></li>
<li>Empty globals for <code>bar</code> are created</li>
<li><code>bar</code> is compiled and starts executing</li>
<li><code>bar</code> imports <code>foo</code> (which is a no-op since there already is a module named foo)</li>
<li><code>bar.foo_var = foo.foo_var</code></li>
</ul>
<p>The last step fails, because Python isn’t done with interpreting foo yet and the global symbol dictionary for foo is still empty.</p>
<p>The same thing happens when you use import foo, and then try to access foo.foo_var in global code.</p>
<p>There are (at least) three possible workarounds for this problem.</p>
<p>Guido van Rossum recommends avoiding all uses of from <module> import …, and placing all code inside functions. Initializations of global variables and class variables should use constants or built-in functions only. This means everything from an imported module is referenced as <module>.<name>.</name></module></module></p>
<p>Jim Roskind suggests performing steps in the following order in each module:</p>
<p>exports (globals, functions, and classes that don’t need imported base classes)<br>import statements<br>active code (including globals that are initialized from imported values).<br>van Rossum doesn’t like this approach much because the imports appear in a strange place, but it does work.</p>
<p>Matthias Urlichs recommends restructuring your code so that the recursive import is not necessary in the first place.</p>
<p>These solutions are not mutually exclusive.</p>
<h3 id="import-‘x-y-z’-returns-lt-module-‘x’-gt-how-do-I-get-z"><a href="#import-‘x-y-z’-returns-lt-module-‘x’-gt-how-do-I-get-z" class="headerlink" title="__import__(‘x.y.z’) returns &lt;module ‘x’&gt;; how do I get z?"></a><code>__import__(‘x.y.z’)</code> returns <code>&lt;module ‘x’&gt;</code>; how do I get z?</h3><p>Consider using the convenience function <code>import_module()</code> from <code>importlib</code> instead:<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">z = importlib.import_module(<span class="string">'x.y.z'</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="When-I-edit-an-imported-module-and-reimport-it-the-changes-don’t-show-up-Why-does-this-happen-¶"><a href="#When-I-edit-an-imported-module-and-reimport-it-the-changes-don’t-show-up-Why-does-this-happen-¶" class="headerlink" title="When I edit an imported module and reimport it, the changes don’t show up. Why does this happen?¶"></a>When I edit an imported module and reimport it, the changes don’t show up. Why does this happen?¶</h3><p>For reasons of efficiency as well as consistency, Python only reads the module file on the first time a module is imported. If it didn’t, in a program consisting of many modules where each one imports the same basic module, the basic module would be parsed and re-parsed many times. To force re-reading of a changed module, do this:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> importlib</span><br><span class="line"><span class="keyword">import</span> modname</span><br><span class="line">importlib.reload(modname)</span><br></pre></td></tr></table></figure>
<p>Warning: this technique is not 100% fool-proof. In particular, modules containing statements like</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> modname <span class="keyword">import</span> some_objects</span><br></pre></td></tr></table></figure>
<p>will continue to work with the old version of the imported objects. If the module contains class definitions, existing class instances will not be updated to use the new class definition. This can result in the following paradoxical behaviour:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> importlib</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> cls</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>c = cls.C()                <span class="comment"># Create an instance of C</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>importlib.reload(cls)</span><br><span class="line">&lt;module <span class="string">'cls'</span> <span class="keyword">from</span> <span class="string">'cls.py'</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>isinstance(c, cls.C)       <span class="comment"># isinstance is false?!?</span></span><br><span class="line"><span class="keyword">False</span></span><br><span class="line"><span class="comment">#The nature of the problem is made clear if you print out the “identity” of the class objects:</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>hex(id(c.__class__))</span><br><span class="line"><span class="string">'0x7352a0'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>hex(id(cls.C))</span><br><span class="line"><span class="string">'0x4198d0'</span></span><br></pre></td></tr></table></figure>
</div><div class="tags"><a href="/tags/python/">python</a></div><div class="post-nav"><a class="pre" href="/消除序列中重复元素的最好方法/">消除序列中重复元素的最好方法</a><a class="next" href="/linux获取文件编码/">linux获取文件编码</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/源码解读/" style="font-size: 15px;">源码解读</a> <a href="/tags/es/" style="font-size: 15px;">es</a> <a href="/tags/flask/" style="font-size: 15px;">flask</a> <a href="/tags/http/" style="font-size: 15px;">http</a> <a href="/tags/flask源码/" style="font-size: 15px;">flask源码</a> <a href="/tags/flask路由/" style="font-size: 15px;">flask路由</a> <a href="/tags/k8s/" style="font-size: 15px;">k8s</a> <a href="/tags/路由寻址/" style="font-size: 15px;">路由寻址</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/脚本/" style="font-size: 15px;">脚本</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/常用函数/" style="font-size: 15px;">常用函数</a> <a href="/tags/redis/" style="font-size: 15px;">redis</a> <a href="/tags/消息队列/" style="font-size: 15px;">消息队列</a> <a href="/tags/tcp协议/" style="font-size: 15px;">tcp协议</a> <a href="/tags/开发环境配置/" style="font-size: 15px;">开发环境配置</a> <a href="/tags/算法/" style="font-size: 15px;">算法</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/转载-国内比较有名的自动驾驶公司/">转载___国内比较有名的自动驾驶公司</a></li><li class="post-list-item"><a class="post-list-link" href="/高并发优化的一些经验/">高并发优化的一些经验</a></li><li class="post-list-item"><a class="post-list-link" href="/写在使用es前/">写在使用es前</a></li><li class="post-list-item"><a class="post-list-link" href="/sql语法/">sql语法</a></li><li class="post-list-item"><a class="post-list-link" href="/mysql临时表/">mysql临时表</a></li><li class="post-list-item"><a class="post-list-link" href="/上传文件中中文名称的处理和python实现/">flask上传文件中文名称的处理</a></li><li class="post-list-item"><a class="post-list-link" href="/redis基本操作/">redis基本操作</a></li><li class="post-list-item"><a class="post-list-link" href="/redis对象/">redis对象</a></li><li class="post-list-item"><a class="post-list-link" href="/redis数据结构/">redis数据结构</a></li><li class="post-list-item"><a class="post-list-link" href="/redis高可用/">redis高可用</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2019 <a href="/." rel="nofollow">吃饭不喝汤.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>